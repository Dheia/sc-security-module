# ---------------------------------------------------------------
# Imunify360 ModSecurity Rules
# Copyright (C) 2018 Cloud Linux Inc All right reserved
# The Imunify360 ModSecurity Rules is distributed under
# IMUNIFY360 LICENSE AGREEMENT
# Please see the enclosed IM360-LICENSE.txt file for full details.
# ---------------------------------------------------------------
# Imunify360 custom ruleset

SecRule REQUEST_URI "!@rx (/wp-admin/|/wp-content/|/forum/)" "id:77140730,chain,phase:2,log,deny,t:urlDecode,t:removeWhitespace,msg:'Drupalgeddon test||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'drupal_core'"
SecRule REQUEST_COOKIES_NAMES|ARGS_NAMES "(\[[^\w]{0,99}[\"'`]?#[^\]]{0,99}\])|(#\[)"

SecRule REQUEST_URI "!@rx (/wp-admin/|/wp-content/|/forum/)" "id:77140731,chain,phase:2,log,deny,t:urlDecode,t:removeWhitespace,msg:'Drupal CVE-2018-7600/02 RCE attempt||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'drupal_core'"
SecRule ARGS|ARGS_NAMES "(q\[%23type\])|(q\[%23markup\])|(\[%23\]\[\])|(\[#\]\[\])|(\[%2523\]\[\])"

SecRule REQUEST_COOKIES:X-XSRF-TOKEN "(\S{41,})" "phase:request,id:77140733,t:urlDecodeUni,deny,msg:'CVE-2018-15133 exploitation attempt||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"

# https://www.exploit-db.com/raw/45108/
SecRule REQUEST_URI "@rx \/db\-password:[^\.]{0,108}\.request\.[^\|]{0,108}\|" "id:77140734,phase:request,log,deny,t:urlDecode,t:lowercase,msg:'CVE-2018-14716 exploitation attempt||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'other_apps'"

# Heuristic: WebShellAccess
SecRule REQUEST_URI "!@rx (?:\/(wp-spamfree|com_breezingforms|midway\/framework\/assets))" "chain,id:77140735,phase:request,log,pass,t:none,t:urlDecodeUni,t:normalizePath,msg:'Suspicious access attempt (webshell)!||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}||SC:%{SCRIPT_FILENAME}',tag:'i360custom',tag:'noshow'"
SecRule REQUEST_URI "@rx (\/(images|img(s)?|pictures|upload(s)?)\/[^\.]{0,108}\.(pht|phtml|php\d?$))" "t:none,t:urlDecodeUni,t:normalizePath"

SecRule REQUEST_URI "!@rx (?:\/(wp-spamfree|com_breezingforms|midway\/framework\/assets))" "chain,id:77140878,phase:request,log,block,t:none,t:urlDecodeUni,t:normalizePath,msg:'Infectors: Suspicious access attempt (webshell)!||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}||SC:%{SCRIPT_FILENAME}',tag:'i360custom',tag:'noshow'"
SecRule REQUEST_URI "@rx (\/(images|img(s)?|pictures|upload(s)?)\/[^\.]{0,108}\.(pht|phtml|php\d?$))" "t:none,t:urlDecodeUni,t:normalizePath,chain"
SecRule TX:RBL_IP "@rbl infectors.v2.rbl.imunify.com." "t:none,chain"
SecRule TX:RBL_IP "!@rbl nxdomain.v2.rbl.imunify.com." "t:none"

# Track DrupalJoomla spammers
SecRule REQUEST_URI|ARGS_NAMES|ARGS:submit|ARGS:jtxf "@rx (Post\sComment|v2\/comments[^\/]{0,108}content|comment_body\[|JCommentsAddComment)" "id:77140736,phase:request,auditlog,pass,t:none,t:urlDecodeUni,t:normalizePath,msg:'WP/DRUPAL/JOOMLA comments analysis||MVN:%{MATCHED_VAR_NAME}||MV:WP_DRUPAL_JOOMLA_COMMENT||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'noshow'"

# Block DrupalJoomla spammers
SecRule REQUEST_URI|ARGS_NAMES|ARGS:submit|ARGS:jtxf "@rx (Post\sComment|v2\/comments[^\/]{0,108}content|comment_body\[|JCommentsAddComment)" "id:77140835,phase:request,auditlog,block,t:none,t:urlDecodeUni,t:normalizePath,msg:'Block Drupal/Joomla spammers||MVN:%{MATCHED_VAR_NAME}||MV:WP_DRUPAL_JOOMLA_COMMENT||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'noshow',chain"
SecRule REMOTE_ADDR "@rbl web-spammers.v2.rbl.imunify.com." "t:none,chain"
SecRule REMOTE_ADDR "!@rbl nxdomain.v2.rbl.imunify.com." "t:none"

# Heuristic: WPDuplicatorRCE
# WP duplicator RCE https://www.synacktiv.com/ressources/advisories/WordPress_Duplicator-1.2.40-RCE.pdf
SecRule REQUEST_METHOD "POST" "id:77140737,chain,phase:2,t:none,deny,log,msg:'Wordpress Duplicator - RCE||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_plugin_duplicator'"
SecRule REQUEST_URI "@pm /installer-backup.php /installer.php" "chain,t:none,t:lowercase,t:urlDecode"
SecRule ARGS "@rx ('\)\;)" "t:none,t:lowercase,t:urlDecode"

# Heuristic: DirectoryBruteForce
SecRule REQUEST_FILENAME "@pmFromFile userdata_dirb_URLs.data" "id:77140739,phase:request,log,pass,t:urlDecode,t:removeWhitespace,t:lowercase,msg:'Dirb like fuzzing||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'noshow'"

# Heuristic: TwentyShell
SecRule REQUEST_URI "@rx \/wp-content\/themes\/twenty[^\.]{0,108}\.php" "id:77140740,phase:2,log,deny,t:urlDecode,t:removeWhitespace,msg:'Twenty shell abuse attempt||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_core'"

# Heuristic: SuspiciousAccess
SecRule REQUEST_URI "@pm /wp-content/uploads/2018/10/mod_config.php /wp-content/plugins/wp-to-twitter/tmhOAuth/sys.php.php /wp-content/themes/better-mag/footer.php /wp-content/plugins/sfn.php /wp-admin/yt.php /assets/images/accesson.php /wp-admin/maint/index.php /wp-admin/includes/index.php /wp-includes/css/login_wall.php /wp-logos.php /wp-icoud.php /wp-cahce.php /wp-content/indes.php /wp-includes/indes.php /wp-conde.php" "id:77140742,phase:2,log,deny,t:urlDecode,t:removeWhitespace,msg:'Block abusive scripts||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_core'"

# Heuristic: MaliciousAccess
SecRule REQUEST_URI "@pm /media/media.php /mother.php /yt.php /wp-logos.php /temp.php /yt2.php /indes.php" "id:77140743,chain,phase:2,log,deny,t:urlDecode,t:removeWhitespace,msg:'Block malicious scripts access||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule TX:MISS_UA|TX:SQL_INJECT|TX:PHP_INJECT "@gt 0" "t:none"

# Heuristic: BlockPHPInjection
SecRule REQUEST_URI "!@rx (/wp-admin/post.php|/wp-admin/admin-ajax.php)" "id:77140745,chain,phase:2,log,block,t:urlDecode,t:removeWhitespace,msg:'Block php injections||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS "@rx (set_magic_quotes_runtime\(0\))" "chain"
SecRule TX:MISS_UA "@gt 0" "t:none"

# SA-CORE-2018-006 mail() RCE
SecRule ARGS "@rx (\s-oQ/|\s-be\s\${run)" "id:77140746,phase:2,log,deny,t:urlDecode,msg:'SA-CORE-2018-006 mail() RCE||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'drupal_core'"

# CVE-2018-9206 (jQuery File Uploader)
SecRule REQUEST_URI "@rx \/jQuery-File-Upload[^\.](\/server\/php\/upload\.class\.php|\/example\/upload\.php|\/server\/php/UploadHandler\.php|\/php\/index\.php|\/server\/php\/index\.php)" "id:77140747,chain,phase:2,log,deny,t:urlDecode,t:removeWhitespace,msg:'CVE-2018-9206||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule FILES:files "@rx (\.htaccess|.+\.(pht|phtml|php\d?)$)" "t:lowercase,t:urlDecode,t:removeWhitespace"

# Privilege Escalation Flaw In WP GDPR
SecRule REQUEST_URI "@rx (/wp-admin/admin-ajax.php)" "id:77140750,chain,phase:2,log,deny,t:urlDecode,t:removeWhitespace,msg:'Privilege Escalation Flaw In WP GDPR||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_plugin_wp_gdpr_compliance'"
SecRule ARGS "@rx (wpgdprc_process_action)" "chain"
SecRule ARGS "@rx (\"option\"\s*?:\s*?\"users_can_register\"\s*?,\s*?\"value\"\s*?:\s*?\"1\"|\"default_role\"\s*?,\s*?\"value\"\s*?:\s*?\"administrator\")"

# RCE IFS anti-bypass
SecRule ARGS "@rx (\$IFS\$|\$\{IFS\})" "id:77140751,phase:2,log,deny,t:urlDecode,t:removeWhitespace,msg:'RCE IFS anti-bypass||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"

# CVE-2019-6703
SecRule REQUEST_URI "@rx (/wp-admin/admin-ajax.php|/wp-content/plugins/wp-total-donations/the-ajax-caller.php)" "id:77140752,chain,phase:2,log,deny,t:urlDecode,t:removeWhitespace,msg:'WP Total Donations Plugin vulnerability CVE-2019-6703||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_core'"
SecRule ARGS "@rx (miglaA_update_me|miglaA_update_arr|miglaA_update_barinfo)" "chain"
SecRule ARGS "@rx (\"option\"\s*?:\s*?\"users_can_register\"\s*?,\s*?\"value\"\s*?:\s*?\"1\"|\"default_role\"\s*?,\s*?\"value\"\s*?:\s*?\"administrator\")"

# CVE-2018-20062
SecRule ARGS:s "@streq index/\\think\\Request/input" "id:77140753,chain,phase:request,log,deny,t:urlDecode,msg:'CVE-2018-20062||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'other_apps'"
SecRule &ARGS:filter "@ge 1"

# CVE-2019-6339 tracking rule
SecRule ARGS "@rx (\.phar$|^phar:\/\/)" "id:77140754,phase:request,log,pass,t:urlDecode,msg:'CVE-2019-6339 tracking rule||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'drupal_core',tag:'noshow'"

# CVE-2019-6340
SecRule REQUEST_METHOD "^GET$" "id:77140755,chain,phase:request,log,deny,setvar:TX.body_length=%{REQUEST_BODY_LENGTH},t:urlDecode,msg:'CVE-2019-6340||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'drupal_core'"
SecRule ARGS:_format "@streq hal_json" "chain"
SecRule TX:body_length "@ge 500"

# CVE-2019-6977 CVE-2019-8943 DEFA-1065
SecRule REQUEST_METHOD "POST" "id:77140756,chain,phase:2,t:none,block,log,msg:'Path traversal vulnerability in WordPress CVE-2019-6977 CVE-2019-8943||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_core',tag:'noshow'"
SecRule REQUEST_FILENAME "@endsWith /wp-admin/post.php" "chain,t:none,t:lowercase,t:urlDecode,t:normalizePath"
SecRule ARGS:meta_input[_wp_attached_file] "@rx \.\.\/\.\.\/" "t:none,t:lowercase,t:urlDecode,t:normalizePath"

# https://blog.ripstech.com/2019/wordpress-csrf-to-rce/
SecRule REQUEST_METHOD "POST" "id:77140757,chain,msg:'IM360 WAF: WordPress 5.1 comments CSRF||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',phase:2,pass,log,t:none,tag:'i360custom',tag:'wp_core',tag:'noshow'"
SecRule &ARGS:_wpnonce "@eq 0" "chain,t:none"
SecRule REQUEST_FILENAME "@rx (?:admin\-ajax|comment).php$" "chain,t:none,t:lowercase"
SecRule &REQUEST_COOKIES:wp_session "@ge 1" "chain,t:none"
SecRule REQUEST_HEADERS:Referer "!@contains %{SERVER_NAME}" "t:none,t:lowercase"

# Rule 140758 is only for LiteSpeed

# Rule 140759 is covered by rule 232920

# SQL Injection vulnerability in Magento Open Source prior to 1.9.4.1, and Magento Commerce prior to 1.14.4.1, Magento 2.1 prior to 2.1.17, Magento 2.2 prior to 2.2.8, Magento 2.3 prior to 2.3.1. PRODSECBUG-2198 DEFA-1031 DEFA-1032
SecRule REQUEST_URI "@contains product_frontend_action/synchronize" "phase:2,log,deny,id:77140760,chain,t:none,t:normalizePath,t:urlDecodeUni,msg:'SQL Injection vulnerability in Magento PRODSECBUG-2198||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'other_apps'"
SecRule ARGS_GET:type_id "@streq recently_products" "chain,t:none,t:urlDecodeUni"
SecRule ARGS_GET:ids[0][product_id][from] "@rx \?" "chain,t:none,t:urlDecodeUni"
SecRule ARGS_GET:ids[0][product_id][to] "@rx \)\)\)" "t:none,t:lowercase"

# DEFA-1055 Tracking rule for WSO checker
SecRule REQUEST_URI "@contains /wp-content/uploads/" "id:77140761,chain,phase:2,log,deny,t:normalizePath,msg:'Blocking filenames collected with WSO checker||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule REQUEST_BASENAME "@rx (blackhat|wp-console|ask|idx|aul|wawa|content-post)\.php" "t:none"

# DEFA-1650 FP on Bitrix installations
# DEFA-1073 Blocking variable zzz in URI
SecRule REQUEST_BASENAME "@endsWith .php" "id:77140762,chain,block,phase:2,log,msg:'Blocking variable zzz in URI||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'noshow'"
SecRule REQUEST_FILENAME "!@rx \/admin\/1c_exchange\.php$" "chain,t:none,t:urlDecodeUni"
SecRule ARGS_NAMES "@rx ^zzz$" "t:none"

# DEFA-1226 Rule 140763 deleted due to FP

# DEFA-1084 CSRF vulnerability in Joomla Core 1.5.0 - 3.9.4
SecRule REQUEST_COOKIES:/^[a-f0-9]{32}$/ "@rx ^(?:[a-z0-9]{26}|[a-z0-9]{32})$" "id:77140764,chain,block,phase:2,log,t:none,t:urlDecodeUni,t:normalizePath,msg:'CSRF vulnerability in Joomla Core 1.5.0 - 3.9.4||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'joomla_core'"
SecRule ARGS:option "@streq com_media" "chain,t:none,t:lowercase"
SecRule ARGS:view "@streq mediaList" "chain,t:none,t:lowercase"
SecRule ARGS:tmpl "@streq component" "chain,t:none,t:lowercase"
SecRule REQUEST_HEADERS:Referer "!@streq %{SERVER_NAME}" "t:none,t:lowercase"

# DEFA-1084 Directory Traversal vulnerability in Joomla Core 1.5.0 - 3.9.4
SecRule REQUEST_COOKIES:/^[a-f0-9]{32}$/ "@rx ^(?:[a-z0-9]{26}|[a-z0-9]{32})$" "id:77140765,chain,block,phase:2,log,t:none,t:urlDecodeUni,t:normalizePath,msg:'Directory Traversal vulnerability in Joomla Core 1.5.0 - 3.9.4||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'joomla_core'"
SecRule ARGS:option "@streq com_media" "chain,t:none,t:lowercase"
SecRule ARGS:view "@streq mediaList" "chain,t:none,t:lowercase"
SecRule ARGS:tmpl "@streq component" "chain,t:none,t:lowercase"
SecRule ARGS:folder "@rx \/\.\." "t:none,t:normalizePath"

# DEFA-1105 Object.prototype pollution in jQuery JavaScript library (CVE-2019-11358)
SecRule REQUEST_BODY_LENGTH "!@gt 12000" "id:77140766,chain,pass,phase:2,log,msg:'Object.prototype pollution in jQuery JavaScript library (CVE-2019-11358)||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule REQUEST_BODY "@rx \.(?:extend|assign)\((?:[\s\n]{0,20})true\,[^$]{3,108}__proto__" "t:none,t:urlDecodeUni"

# DEFA-1108 Local file inclusion vulnerability in Contact Form Builder plugin for WordPress
SecRule REQUEST_FILENAME "@endsWith wp-admin/admin-ajax.php" "id:77140767,chain,block,phase:2,log,msg:'Local file inclusion vulnerability in Contact Form Builder plugin for WordPress||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_plugin_contact_form_builder'"
SecRule ARGS_POST:action "@pm CFMShortcode ContactFormMakerPreview ContactFormmakerwdcaptcha nopriv_ContactFormmakerwdcaptcha" "chain,t:none"
SecRule ARGS_GET:action "@rx \.\.\/\.\.\/" "t:none,t:lowercase,t:urlDecodeUni"


# DEFA-1121 File upload vulnerability in WooCommerce plugin for WordPress
SecRule REQUEST_FILENAME "@contains wp-admin/admin-ajax.php" "id:77140768,chain,phase:2,log,pass,t:urlDecodeUni,t:removeWhitespace,msg:'File upload vulnerability in WooCommerce plugin for WordPress||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_plugin_woocommerce'"
SecRule ARGS:action "@contains wccs_upload_file_func" "chain,t:none"
SecRule &ARGS:order_id "!@eq 0" "chain"
SecRule &ARGS:name "!@eq 0" "chain"
SecRule FILES "@rx \.(?:php\d?|js|p(?:l|y)|rb|sh|(?:p|s|x|d)?html?\d?|aspx?|cgi|exe|dll|com|htaccess)$"

# DEFA-1121 File upload vulnerability in WooCommerce plugin for WordPress
SecRule REQUEST_FILENAME "@contains /wp-content/uploads/wooccm_uploads/" "id:77140769,chain,phase:2,log,pass,t:urlDecodeUni,t:removeWhitespace,msg:'File upload vulnerability in WooCommerce plugin for WordPress||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_plugin_woocommerce'"
SecRule FILES "@rx \.(?:php\d?|js|p(?:l|y)|rb|sh|(?:p|s|x|d)?html?\d?|aspx?|cgi|exe|dll|com|htaccess)$" "t:none,t:urlDecodeUni"

# DEFA-1159 Suspicious user-agent
SecRule REQUEST_HEADERS:User-Agent "@rx ^Mozilla\/5\.0 \(3\.1\.final\)" "id:77140770,phase:2,pass,log,t:none,t:urlDecodeUni,msg:'Suspicious User-Agent detected||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"

# DEFA-1205 Persistent XSS in WP Live Chat Support Plugin for WordPress
SecRule REQUEST_FILENAME "@rx \/wp-admin\/admin-(?:post|ajax)\.php" "id:77140771,chain,phase:2,log,pass,t:none,t:urlDecodeUni,t:normalizePath,msg:'Persistent XSS in WP Live Chat Support Plugin for WordPress||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS_POST:wplc_custom_js "!@rx ^$" "t:none"

# DEFA-1205 Unauthenticated stored XSS in FV Flowplayer Video Player plugin for WordPress
SecRule REQUEST_METHOD "POST" "id:77140772,chain,phase:2,log,pass,t:none,msg:'Unauthenticated stored XSS in FV Flowplayer Video Player plugin for WordPress||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule REQUEST_FILENAME "@endsWith wp-admin/admin-ajax.php" "chain,t:none,t:urlDecodeUni,t:normalizePath"
SecRule ARGS_POST:action "@contains fv_wp_flowplayer_email_signup" "chain,t:none,t:urlDecodeUni"
SecRule &ARGS_POST:list "@gt 0" "chain,t:none"
SecRule ARGS_POST:email "<" "t:none,t:urlDecodeUni"

# DEFA-1205 Information Disclosure Vulnerability in FV Player plugin for WordPress
SecRule REQUEST_FILENAME "@endsWith /wp-admin/admin-post.php" "id:77140773,chain,phase:2,log,pass,t:none,t:urlDecodeUni,t:normalizePath,msg:'Information Disclosure Vulnerability in FV Player plugin for WordPress||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS:page "fvplayer" "chain,t:none"
SecRule ARGS:fv-email-export "!@rx ^$" "t:none"

# DEFA-1205 Unauthenticated Open Redirect vulnerability in Newsletter Manager plugin for WordPress
SecRule ARGS:wp_nlm "@rx confirmation" "id:77140774,chain,phase:2,log,pass,t:none,t:urlDecodeUni,msg:'||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS:appurl "!@rx ^$" "t:none"

# DEFA-1205 Stored XSS vulnerability in Live Chat with Facebook Messenger plugin for WordPress
SecRule REQUEST_FILENAME "@endsWith wp-admin/admin-ajax.php" "id:77140775,chain,phase:2,log,pass,t:none,t:urlDecodeUni,t:normalizePath,msg:'Stored XSS vulnerability in Live Chat with Facebook Messenger plugin for WordPress||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS:action "@rx update_zb_fbc_code" "chain,t:none"
SecRule ARGS:domain "@rx <" "t:none,t:urlDecodeUni"

# DEFA-1244
SecRule REQUEST_FILENAME "@endsWith wp-admin/admin-ajax.php" "id:77140776,chain,block,t:none,t:lowercase,t:normalizePath,msg:'Convert Plus WordPress plugin flaw allows hackers to create Admin accounts||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS_POST:action "@streq cp_add_subscriber" "chain,t:none"
SecRule ARGS_POST:cp_set_user "@streq administrator" "t:none,t:lowercase"

# DEFA-1103
SecRule REQUEST_COOKIES_NAMES:/^PrestaShop/ "!@rx ^$" "id:77140777,chain,block,t:none,msg:'Block spam Customer Account in PrestaShop||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS_POST:lastname|ARGS_POST:firstname "@rx www|http" "t:none,t:lowercase"
# DEFA-1103
SecRule REQUEST_COOKIES_NAMES:/^PrestaShop/ "!@rx ^$" "id:77140778,chain,block,t:none,msg:'Block spam Customer Account in PrestaShop||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS_POST:lastname|ARGS_POST:firstname "!@rx ^[^0-9!\[\]<>,;?=+()@#\"{}_$%:\/\\\*\^]*$" "t:none,t:urlDecodeUni"

# DEFA-1203
SecRule REQUEST_FILENAME "@endsWith /wp-admin/admin-ajax.php" "id:77140779,chain,pass,t:none,t:normalizePath,msg:'XSS vulnerability in FB Messenger Live Chat For||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS:action "@streq update_zb_fbc_code" "chain,t:none"
SecRule ARGS:domain "@rx <\/" "t:none"

# DEFA-1277
SecRule REQUEST_FILENAME "@endsWith /wp-admin/admin-ajax.php" "id:77140780,chain,block,t:none,t:normalizePath,msg:'New user account role escalation in many plugins for WordPress||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS:action "@streq fs_set_db_option" "chain"
SecRule ARGS:option_name "@streq users_can_register" "chain"
SecRule ARGS:option_value "@gt 0"

# DEFA-1290
SecRule REQUEST_FILENAME "@endsWith wp-admin/admin.php" "id:77140781,chain,block,t:none,t:normalizePath,msg:'SQL injection in WordPress plugin Form Maker 1.13.3||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS:page "@streq submissions_fm" "chain,t:none"
SecRule ARGS:task "@streq display" "chain,t:none"
SecRule &ARGS:current_id "!@eq 0" "chain,t:none"
SecRule ARGS:asc_or_desc "!@rx ^(asc|desc)$" "t:none"

# DEFA-1291
SecRule REQUEST_FILENAME "@endsWith /package-updates/update.cgi" "id:77140782,chain,block,t:none,t:normalizePath,msg:'Remote command execution in Package Updates of Webmin 1.910||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule REQUEST_HEADERS:Referer "@rx \/package-updates\/\?xnavigation=1" "chain,t:none,t:urlDecodeUni"
SecRule ARGS_POST:ok_top "@rx ^Update Selected Packages$" "chain,t:none"
SecRule &ARGS_POST:u "@gt 1" "chain,t:none"
SecRule ARGS_POST:u "@rx ^ ?|" "t:none,t:urlDecodeUni"

# DEFA-1359
SecRule REQUEST_BASENAME "@endsWith index.php" "id:77140783,chain,block,t:none,t:normalizePath,msg:'XSS vulnerability in ZoneMinder 1.32.3||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS_GET:view "@streq filter" "chain,t:none"
SecRule &ARGS_GET:sort_field "@gt 0" "chain,t:none"
SecRule ARGS_POST:action "@streq save" "chain,t:none,t:lowercase"
SecRule ARGS_POST:filter[Name] "@rx <" "t:none"

# DEFA-1360
SecRule REQUEST_BASENAME "@endsWith wp-admin/admin-ajax.php" "id:77140784,chain,block,t:none,t:normalizePath,msg:'XSS vulnerability in ZoneMinder 1.32.3||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS_POST:action "@streq newsletters_exportmultiple" "chain,t:none"
SecRule ARGS_POST:exportfile "@rx \.\.\/\.\.\/" "chain,t:none,t:lowercase"
SecRule ARGS_POST:/subscribers\[/ "@rx <" "t:none"

# DEFA-1361
SecRule REQUEST_BASENAME "@endsWith wp-admin/admin-ajax.php" "id:77140785,chain,block,t:none,t:normalizePath,msg:'Reflected XSS vulnerability in Newsletters plugin for WordPress||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS_GET:action "@streq newsletters_load_new_editor" "chain,t:none"
SecRule ARGS_GET:contentarea "@rx \x22" "t:none"

# DEFA-1362
SecRule &ARGS_POST:wp_statistics_hit "@gt 0" "id:77140786,chain,block,t:none,t:normalizePath,msg:'Unauthenticated blind SQLi vulnerability in WP Statistics before 12.6.6.1 plugin for WordPress||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule &ARGS_POST:wp_statistics_hit[track_all] "@gt 0" "chain,t:none"
SecRule &ARGS_POST:wp_statistics_hit[page_uri] "@gt 0" "chain,t:none"
SecRule ARGS_POST:wp_statistics_hit[search_query] "@rx \'"

# DEFA-1377
SecRule REQUEST_URI "rx \/wp-admin\/" "id:77140787,chain,block,t:none,t:normalizePath,msg:'Authenticated persistent XSS vulnerability WP Google Maps plugin for WordPress||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule &ARGS_POST:wpgmaps_map_id "@ge 1" "chain,t:none"
SecRule &ARGS_POST:rectangle_color "@ge 1" "chain,t:none"
SecRule ARGS_POST:rectangle_name|ARGS_POST:rectangle_opacity "@rx \x22" "t:none,t:urlDecodeUni"

# DEFA-1378
SecRule REQUEST_BASENAME "@endsWith /wp-admin/admin.php" "id:77140788,chain,block,t:none,t:normalizePath,msg:'XSS vulnerability in Galery Photobloks plugin for WordPress||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS:page "@streq photoblocks-edit" "chain,t:none"
SecRule ARGS:id "@rx \x22" "t:none,t:urlDecodeUni"

# DEFA-1415
SecRule REQUEST_BASENAME "@endsWith /wp-admin/admin.php" "id:77140789,chain,block,t:none,t:normalizePath,msg:'SQLi vulnerability in AdRotate for WordPress||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS_GET:page "@streq adrotate-ads" "chain,t:none"
SecRule ARGS_GET:view "@streq edit" "chain,t:none"
SecRule ARGS_POST:ad "@contains (" "t:none,t:urlDecodeUni"

# DEFA-1416
SecRule REQUEST_BASENAME "@endsWith /wp-admin/admin-post.php" "id:77140790,chain,block,t:none,t:normalizePath,msg:'Authenticated XSS vulnerability in Project Supremacy Lite for WordPress||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule &REQUEST_COOKIES:/wordpress_logged_in/ "@ge 1" "chain,t:none"
SecRule ARGS:action "@streq prs_save_general" "chain,t:none"
SecRule ARGS_POST:ps_seo_global_scripts "@contains <" "t:none,t:urlDecodeUni"

# DEFA-1417
SecRule REQUEST_HEADERS:X-SUCURI-CLIENTIP "@rx \x22" "id:77140791,block,t:none,t:normalizePath,msg:'Persistent XSS vulnerability in WPS Limit Login for WordPress||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"

# DEFA-1418
SecRule REQUEST_BASENAME "@endsWith wp-admin/admin.php" "id:77140792,chain,block,t:none,t:normalizePath,msg:'Persistent XSS vulnerability in Plugin OneSignal 1.17.5 for WordPress||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS_GET:page "@streq onesignal-push" "chain,t:none"
SecRule &ARGS_POST:onesignal_config_page_nonce "@ge 1" "chain,t:none"
SecRule ARGS_POST:subdomain "@rx \x22" "t:urlDecodeUni"

# DEFA-1450
SecRule REQUEST_BASENAME "@endsWith /wp-admin/admin.php" "id:77140793,chain,block,t:none,t:normalizePath,msg:'Reflected XSS vunerability in WooCommerce Product Feed for WordPress||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS_GET:page "@streq woo_feed_manage_feed" "chain,t:none"
SecRule ARGS_GET:link "@rx \x22" "t:none,t:urlDecodeUni"

# DEFA-1451
SecRule REQUEST_BASENAME "@endsWith /wp-admin/admin-ajax.php" "id:77140794,chain,block,t:none,t:normalizePath,msg:'Authenticated Persistent XSS vulnerability in Yes-co ORES for WordPress||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule &REQUEST_COOKIES:/wordpress_logged_in/ "@ge 1" "chain,t:none"
SecRule ARGS_GET:action "@streq setsetting" "chain,t:none"
SecRule ARGS_POST:name "@streq yog_google_maps_api_key" "chain,t:none"
SecRule ARGS_POST:value "@rx \x22" "t:none,t:urlDecodeUni"

# DEFA-1452
SecRule REQUEST_BASENAME "@endsWith /wp-admin/options-general.php" "id:77140795,chain,block,t:none,t:normalizePath,msg:'Authenticated Open Redirect Vulnerability in Breeze for WordPress||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule &REQUEST_COOKIES:/wordpress_logged_in/ "@ge 1" "chain,t:none"
SecRule ARGS_GET:page "@streq breeze" "chain,t:none"
SecRule ARGS_GET:_wp_http_referer "!streq %{SERVER_NAME}" "t:none"

# DEFA-1498
SecRule REQUEST_METHOD "@rx ^POST$" "id:77140796,chain,block,t:none,t:normalizePath,msg:'XSS vulnerability in Animate It! plugin for WordPress||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule REQUEST_URI "@endsWith /wp-admin/options-general.php" "chain,t:none,t:normalizePath"
SecRule ARGS_GET:page "@streq animate-it/edsanimate.php" "chain,t:none"
SecRule ARGS_POST:eds_scroll_offset "@rx \x22" "t:none,t:urlDecodeUni"

# DEFA-1499
SecRule REQUEST_URI "@endsWith /wp-admin/admin.php" "id:77140797,chain,block,t:none,t:normalizePath,msg:'XSS vulnerability in WooCommerce Variation Swatches for WordPress||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS_GET:page "@streq woo-variation-swatches-settings" "chain,t:none"
SecRule ARGS_GET:tab "@rx \x22" "t:none,t:urlDecodeUni"

# DEFA-1500
SecRule REQUEST_URI "@endsWith /wp-admin/edit.php" "id:77140798,chain,block,t:none,t:normalizePath,msg:'Authenticated SQL injection vulnerability in Popup Builder for WordPress||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS_GET:page "@streq sgpbSubscribers" "chain,t:none"
SecRule ARGS_GET:post_type "@streq popupbuilder" "chain,t:none"
SecRule ARGS_GET:order "!@rx ^(?:asc|desc)$" "t:none"

# DEFA-1528
SecRule REQUEST_FILENAME "@endsWith /wp-admin/admin.php" "id:77140799,chain,block,t:none,t:normalizePath,msg:'CSRF vulnerability in Post SMTP plugin for WordPress||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS_GET:page "@streq postman_email_log" "chain,t:none"
SecRule &REQUEST_COOKIES:/wordpress_logged_in/ "@ge 1" "chain,t:none"
SecRule REQUEST_HEADERS:Referer "!@contains %{SERVER_NAME}" "t:none"

# DEFA-1529
SecRule REQUEST_METHOD "@streq POST" "id:77140800,chain,block,t:none,t:normalizePath,msg:'XSS vulnerability in Maintenance plugin for WordPress||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule REQUEST_FILENAME "@endsWith /wp-admin/admin.php" "chain,t:none,t:normalizePath"
SecRule ARGS_GET:page "@streq maintenance" "chain,t:none"
SecRule ARGS_POST:lib_options[page_title] "@rx \x22" "t:none"

SecRule REQUEST_METHOD "@streq POST" "id:77140801,chain,block,t:none,t:normalizePath,msg:'CSRF vulnerability in Maintenance plugin for WordPress||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule REQUEST_FILENAME "@endsWith /wp-admin/admin.php" "chain,t:none,t:normalizePath"
SecRule ARGS_GET:page "@streq maintenance" "chain,t:none"
SecRule ARGS:state "@streq on" "chain,t:none"
SecRule REQUEST_HEADERS:Referer "!@contains %{SERVER_NAME}" "t:none"

# DEFA-1327
SecRule REQUEST_METHOD "POST" "id:77140802,chain,msg:'IM360 WAF: CSRF vulnerability in Facebook for WooCommerce plugin before 1.9.14 for WordPress||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',phase:2,block,log,t:none,tag:'i360custom',tag:'wp_plugin_facebook_for_woocommerce'"
SecRule REQUEST_FILENAME "@endsWith /wp-admin/admin-ajax.php" "chain,t:none,t:lowercase"
SecRule &ARGS:_wpnonce "@eq 0" "chain,t:none"
SecRule ARGS:action "@streq ajax_update_fb_option" "chain,t:none,t:lowercase"
SecRule REQUEST_HEADERS:Referer "!@contains %{SERVER_NAME}" "t:none,t:lowercase"

SecRule REQUEST_METHOD "POST" "id:77140803,chain,msg:'IM360 WAF: CSRF vulnerability in Messenger Customer Chat plugin before 1.3 for WordPress||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',phase:2,block,log,t:none,tag:'i360custom',tag:'wp_plugin_facebook_messenger_customer_chat'"
SecRule REQUEST_FILENAME "@endsWith /wp-admin/admin-ajax.php" "chain,t:none,t:lowercase"
SecRule &ARGS:_wpnonce "@eq 0" "chain,t:none"
SecRule ARGS:action "@streq ajax_update_fb_option" "chain,t:none,t:lowercase"
SecRule REQUEST_HEADERS:Referer "!@contains %{SERVER_NAME}" "t:none,t:lowercase"

# Block shells found via IP record
SecRule ARGS_POST:cp "@streq download" "id:77140804,chain,phase:2,log,block,t:urlDecode,t:removeWhitespace,msg:'Block known shells||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS_POST:url "@contains http" "t:none"

SecRule ARGS_GET:url "@contains pastebin.com" "id:77140805,chain,phase:2,log,block,t:urlDecode,t:removeWhitespace,msg:'Block known shells||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS_GET:path "!@rx ^$" "t:none"

SecRule ARGS_POST:a "@streq Php" "id:77140806,chain,phase:2,log,block,t:urlDecode,t:removeWhitespace,msg:'Block known shells||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule REQUEST_URI "@rx (/wp-admin/|/wp-content/)" "t:none"

SecRule REQUEST_URI "@rx (/wp-admin/|/wp-content/)" "id:77140807,chain,phase:2,log,block,t:urlDecode,t:removeWhitespace,msg:'Block known shells||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS_POST:pass "@contains -wso-sell"

SecRule ARGS_POST:info|ARGS_POST:x|ARGS_POST:yt "@contains die(pi()" "id:77140808,chain,phase:2,log,block,t:urlDecode,t:removeWhitespace,msg:'Block known shells||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule REQUEST_URI "@rx (/wp-admin/|/wp-content/)" "t:none"

SecRule ARGS_POST "@contains POST[z0]" "id:77140809,chain,phase:2,log,block,t:urlDecode,t:removeWhitespace,msg:'Block known shells||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule REQUEST_URI "@rx (/wp-admin/|/wp-content/)" "t:none"

SecRule ARGS_POST "@contains 'T'}[z0]" "id:77140810,chain,phase:2,log,block,t:urlDecode,t:removeWhitespace,msg:'Block known shells||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule REQUEST_URI "@rx (/wp-admin/|/wp-content/)" "t:none"

SecRule ARGS_POST "@contains eval(@base64_decode(" "id:77140811,chain,phase:2,log,block,t:urlDecode,t:removeWhitespace,msg:'Block known shells||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule REQUEST_URI "@rx (/wp-admin/|/wp-content/)" "t:none"

SecRule ARGS_POST "@contains eval(get_magic_quotes_gpc()" "id:77140812,chain,phase:2,log,block,t:urlDecode,t:removeWhitespace,msg:'Block known shells||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule REQUEST_URI "@rx (/wp-admin/|/wp-content/)" "t:none"

SecRule ARGS_POST:shall|ARGS_POST:catch|ARGS_POST:yt|ARGS_POST:except|ARGS_POST:user|ARGS_POST:system|ARGS_POST:not|ARGS_POST:accept|ARGS_POST:session|ARGS_POST:pass|ARGS_POST:internal "@contains eval(rawurldecode" "id:77140813,chain,phase:2,log,block,t:urlDecode,t:removeWhitespace,msg:'Block known shells||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule REQUEST_URI "@rx (/wp-admin/|/wp-content/)" "t:none"

SecRule ARGS_POST:q4995c4|ARGS_POST:q2adc32 "@contains eval" "id:77140814,chain,phase:2,log,block,t:urlDecode,t:removeWhitespace,msg:'Block known shells||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule REQUEST_URI "@rx (/wp-admin/|/wp-content/)" "t:none"

SecRule ARGS_POST:pwd "@contains c600e7179c3db8140360ecec6592183a" "id:77140815,chain,phase:2,log,block,t:urlDecode,t:removeWhitespace,msg:'Block known shells||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule REQUEST_URI "@rx (/wp-admin/|/wp-content/|/wp-includes/)" "t:none"

SecRule ARGS_POST:ylxqjqbcn "@contains YmF" "id:77140816,chain,phase:2,log,block,t:urlDecode,t:removeWhitespace,msg:'Block known shells||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule REQUEST_URI "@rx (/wp-admin/|/wp-content/|/wp-includes/)" "t:none"

SecRule ARGS_POST:mtime|ARGS_POST:itongtong "@contains die(" "id:77140817,chain,phase:2,log,block,t:urlDecode,t:removeWhitespace,msg:'Block known shells||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule REQUEST_URI "@rx (/wp-admin/|/wp-content/|/wp-includes/)" "t:none"

SecRule ARGS_POST:pass|ARGS_POST:passwd "@rx (zgFJ_2017_toptu|ce1ce81cd77b04282da88cea6d4a77a9|indexshell)" "id:77140818,chain,phase:2,log,block,t:urlDecode,t:removeWhitespace,msg:'Block known shells||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule REQUEST_URI "@rx (/wp-admin/|/wp-content/|/wp-includes/)" "t:none"

SecRule ARGS_POST:v "@contains up" "id:77140819,chain,phase:2,log,block,t:urlDecode,t:removeWhitespace,msg:'Block known shells||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule REQUEST_URI "@endsWith /wp-includes/css/hi.php" "t:none"

SecRule ARGS_POST:a "@contains RC" "id:77140820,chain,phase:2,log,block,t:urlDecode,t:removeWhitespace,msg:'Block known shells||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule REQUEST_URI "@contains AdvanceImage5" "t:none"

SecRule REQUEST_URI "@endsWith /wp-login.phptheme-editor.php" "id:77140821,chain,phase:2,log,block,t:urlDecode,t:removeWhitespace,msg:'Block known shells||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS_POST:action "@contains update" "t:none"

SecRule ARGS_POST:source "@contains d7.2_x2.0" "id:77140822,phase:2,log,block,t:urlDecode,t:removeWhitespace,msg:'Block known shells||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"

# https://cxsecurity.com/issue/WLB-2019070111
# https://blog.nintechnet.com/privilege-escalation-vulnerability-in-wordpress-nd-donations-plugin/
SecRule REQUEST_URI "@endsWith /wp-admin/admin-post.php" "id:77140823,chain,phase:2,log,block,t:urlDecode,t:removeWhitespace,msg:'Privilege escalation in WordPress ND Donations plugin||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS:action|ARGS:action_rcs "@rx (nd_learning_import_settings_php_function|nd_travel_import_settings_php_function|nd_stats_import_settings_php_function|nd_donations_import_settings_php_function|action_rcs_page_setting_save_post|hc_ajax_save_option|nd_options_import_settings_php_function|nd_booking_import_settings_php_function)" "t:none"

# https://www.exploit-db.com/exploits/46150
SecRule ARGS_POST:_method "@contains __construct" "id:77140824,chain,phase:2,log,block,t:urlDecode,t:removeWhitespace,msg:'thinkphp 5.X RCE||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS_POST:filter[] "@rx (system|assert)" "t:none"

# DEFA-1558
SecRule REQUEST_METHOD "POST" "id:77140825,chain,msg:'IM360 WAF: CSRF vulnerability in WP Add Mime Types plugin before 2.2.1 for WordPress||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',phase:2,block,log,t:none,tag:'i360custom',tag:'wp_plugin_add_mime_types'"
SecRule REQUEST_FILENAME "@endsWith options-general.php" "chain,t:none,t:lowercase"
SecRule ARGS:page "@streq wp-add-mime-types/includes/admin.php" "chain,t:none"
SecRule ARGS:mime_type_values "!@rx ^$" "chain,t:none"
SecRule REQUEST_HEADERS:Referer "!@contains %{SERVER_NAME}" "t:none,t:lowercase"

# DEFA-1558
SecRule ARGS:option "@streq com_fireboard" "id:77140826,chain,msg:'IM360 WAF: SQL Injection vulnerability in Joomla FireBoard 1.1.3 ||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',phase:2,block,log,t:none,tag:'i360custom',tag:'joomla_plugin'"
SecRule ARGS:func "@rx (?:fb_pdf|view|showcat)" "chain,t:none"
SecRule REQUEST_FILENAME "@endsWith index.php" "chain,t:none"
SecRule ARGS:catid|ARGS:Itemid "@rx '|\x22" "t:none,t:urlDecodeUni"

# DEFA-1558
SecRule ARGS:option "@streq com_orgchart" "id:77140827,chain,msg:'IM360 WAF: SQL Injection vulnerabilities in Joomla OrgChart 1.0.0 ||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',phase:2,block,log,t:none,tag:'i360custom',tag:'joomla_plugin'"
SecRule ARGS:task "@streq img" "chain,t:none"
SecRule REQUEST_FILENAME "@endsWith index.php" "chain,t:none"
SecRule ARGS:cat|ARGS:c "@rx '|\x22" "t:none,t:urlDecodeUni"

# DEFA-1558
SecRule ARGS:option "@streq com_alphacontent" "id:77140828,chain,msg:'IM360 WAF: SQL Injection vulnerabilities in Joomla AlphaContent v3. ||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',phase:2,block,log,t:none,tag:'i360custom',tag:'joomla_plugin'"
SecRule &ARGS:section "@ge 1" "chain,t:none"
SecRule REQUEST_FILENAME "@endsWith index.php" "chain,t:none"
SecRule ARGS:limitstart|ARGS:id "@rx '|\x22" "t:none,t:urlDecodeUni"

# DEFA-1589
SecRule ARGS:page "@streq woo_feed_manage_feed" "id:77140829,chain,msg:'IM360 WAF: XSS vulnerability in WooCommerce Product Feed plugin for WordPress||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',phase:2,block,log,t:none,tag:'i360custom',tag:'wp_plugin_woocommerce-product-feed'"
SecRule REQUEST_FILENAME "@endsWith /wp-admin/admin.php" "chain,t:none,t:normalizePath"
SecRule ARGS:link "@rx '" "t:none,t:urlDecodeUni"

# DEFA-1589
SecRule ARGS:option "@streq com_jomestate" "id:77140830,chain,msg:'IM360 WAF: SQL Injection vulnerabilities in Joomla JomEstate v4.1 ||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',phase:2,block,log,t:none,tag:'i360custom',tag:'joomla_plugin'"
SecRule &ARGS:task "@ge 1" "chain,t:none"
SecRule REQUEST_FILENAME "@endsWith index.php" "chain,t:none"
SecRule ARGS:limitstart|ARGS:id|ARGS:Itemid|ARGS:tmpl "@rx '|\x22" "t:none,t:urlDecodeUni"

# DEFA-1589
SecRule REQUEST_URI "@endsWith /component/jomestate/print/id/tmpl/component" "id:77140831,chain,msg:'IM360 WAF: SQL Injection vulnerabilities in Joomla JomEstate v4.1 ||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',phase:2,block,log,t:none,tag:'i360custom',tag:'joomla_plugin'"
SecRule ARGS:limitstart|ARGS:id|ARGS:Itemid|ARGS:tmpl "@rx '|\x22" "chain,t:none,t:urlDecodeUni"
SecRule ARGS_GET:format "@rx \x22|'" "t:none,t:urlDecodeUni"

# DEFA-1589
SecRule ARGS:option "@streq com_easygb" "id:77140832,chain,msg:'IM360 WAF: SQL Injection vulnerabilities in Joomla Easy GuestBook v1.0||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',phase:2,block,log,t:none,tag:'i360custom',tag:'joomla_plugin'"
SecRule &ARGS:task "@ge 1" "chain,t:none"
SecRule REQUEST_FILENAME "@endsWith index.php" "chain,t:none"
SecRule ARGS:Itemid "@rx '|\x22" "t:none,t:urlDecodeUni"

# DEFA-1651
SecRule REQUEST_METHOD "@streq GET" "id:77140833,chain,phase:2,block,log,t:none,t:normalizePath,msg:'IM360 WAF: CSRF vulnerability in phpMyAdmin CVE-2019-12922||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule REQUEST_URI "@contains /setup/" "chain,t:lowercase"
SecRule ARGS_GET:page "@streq servers" "chain,t:none,t:lowercase"
SecRule ARGS_GET:mode "@streq remove" "chain,t:none,t:lowercase"
SecRule REQUEST_HEADERS:Referer "!@contains %{SERVER_NAME}" "t:none,t:lowercase"

# DEFA-1682
SecRule REQUEST_METHOD "@streq POST" "id:77140834,chain,phase:2,block,log,t:none,t:normalizePath,msg:'IM360 WAF: RCE vulnerability in vBulletin v5.x CVE-2019-16759||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule REQUEST_URI|ARGS_POST:routestring "@contains ajax/render/widget_php" "chain,t:lowercase"
SecRule ARGS_POST:widgetConfig[code] "!@rx ^$" "t:none"

# DEFA-1726
SecRule REQUEST_METHOD "@streq POST" "id:77140836,chain,phase:2,block,log,t:none,t:normalizePath,msg:'IM360 WAF: RCE vulnerability in Joomla 3.4.6 CVE-2019-?||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS:task "@streq user.login" "chain,t:lowercase"
SecRule ARGS_POST:username "@contains \\0" "t:urlDecodeUni"

# DEFA-1727
SecRule REQUEST_METHOD "@streq POST" "id:77140837,chain,phase:2,block,log,t:none,t:normalizePath,msg:'IM360 WAF: RCE vulnerability in vBulletin <= 5.5.4 CVE-2019-17132||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS_POST:routestring "@streq ajax/api/user/updateAvatar" "chain,t:urlDecodeUni"
SecRule ARGS_POST:data[extension] "@rx (pht|phtml|php\d?$)" ""

# DEFA-1768
SecRule REQUEST_FILENAME "@endsWith wp-admin/admin-ajax.php" "id:77140838,chain,phase:2,block,log,t:none,t:lowercase,t:normalizePath,msg:'IM360 WAF: WordPress Plugin WP User Frontend < 2.3.11 - Unrestricted Arbitrary File Upload||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_plugin_wpuf'"
SecRule ARGS:action "@streq wpuf_file_upload" "chain,t:none,t:lowercase"
SecRule FILES:wpuf_file "@rx (\.htaccess|.+\.(pht|phtml|php\d?)$)" "t:urlDecodeUni,t:removeWhitespace"

# DEFA-1769
SecRule REQUEST_FILENAME "@endsWith wp-admin/admin-ajax.php" "id:77140839,chain,phase:2,block,log,t:none,t:lowercase,t:normalizePath,msg:'IM360 WAF: Arbitrary File Upload Vulnerability in Adblock Blocker||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_plugin_adblock'"
SecRule ARGS:action "@streq getcountryuser" "chain,t:none,t:lowercase"
SecRule ARGS:cs "!@rx (1|3)" "chain"
SecRule FILES:popimg "@rx (\.htaccess|.+\.(pht|phtml|php\d?)$)" "t:urlDecodeUni,t:removeWhitespace"

# DEFA-1770
SecRule REQUEST_URI "@contains wp-support-plus-responsive-ticket-system" "id:77140840,chain,phase:2,block,log,t:none,t:lowercase,msg:'IM360 WAF: WordPress Plugin WP Support Plus Responsive Ticket System 2.0 Directory Traversal||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_plugin_support_plus'"
SecRule REQUEST_FILENAME "@endsWith downloadAttachment.php" "chain,t:none"
SecRule ARGS_GET:path "@rx \.\.\/" "t:none,t:urlDecodeUni,t:normalizePath"

# DEFA-1771
SecRule REQUEST_FILENAME "@endsWith ungallery/source_vuln.php" "id:77140841,chain,phase:2,block,log,t:none,t:lowercase,t:normalizePath,msg:'IM360 WAF: WordPress UnGallery plugin <= 1.5.8 Local File Disclosure Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_plugin_ungallery'"
SecRule ARGS_GET:pic "@rx \.\.\/" "t:none,t:urlDecodeUni,t:normalizePath"

# DEFA-1772
SecRule REQUEST_METHOD "@streq POST" "id:77140842,chain,phase:2,pass,log,t:none,t:normalizePath,msg:'IM360 WAF: Joomla ADSmanager Exploit Arbitrary File Upload Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'joomla_plugin'"
SecRule ARGS_GET:option "@streq com_adsmanager" "chain,t:none,t:lowercase"
SecRule ARGS_GET:task "@streq upload" "chain,t:none,t:lowercase"
SecRule ARGS_GET:tmpl "@streq component" "chain,t:none,t:lowercase"
SecRule FILES "@rx (\.htaccess|.+\.(pht|phtml|php\d?)$)" "t:urlDecodeUni,t:removeWhitespace"

# DEFA-1773
SecRule REQUEST_METHOD "@streq POST" "id:77140843,chain,phase:2,block,log,t:none,t:normalizePath,msg:'IM360 WAF: Joomla Component com_fabrik File Upload Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'joomla_plugin'"
SecRule ARGS_GET:option "@streq com_fabrik" "chain,t:none,t:lowercase"
SecRule ARGS_GET:view|ARGS_GET:c "@streq import" "chain,t:none,t:lowercase"
SecRule ARGS_GET:filetype "@streq csv" "chain,t:none,t:lowercase"
SecRule FILES "@rx (\.htaccess|.+\.(pht|phtml|php\d?)$)" "t:urlDecodeUni,t:removeWhitespace"

# DEFA-1774
SecRule ARGS_GET:option "@streq com_cckjseblod" "id:77140844,chain,phase:2,block,log,t:none,t:lowercase,msg:'IM360 WAF: Joomla com_cckjseblod Local File Download Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'joomla_plugin'"
SecRule ARGS_GET:task "@streq download" "chain,t:none,t:lowercase"
SecRule ARGS_GET:file "@streq configuration.php" "t:none"

# DEFA-1775
SecRule REQUEST_FILENAME "@endsWith com_hdflvplayer/hdflvplayer/download.php" "id:77140845,chain,phase:2,block,log,t:none,t:lowercase,t:normalizePath,msg:'IM360 WAF: Joomla HD FLV 2.1.0.1 and below Arbitrary File Download Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'joomla_plugin'"
SecRule ARGS_GET:f "@rx \.\.\/" "t:none,t:urlDecodeUni,t:normalizePath"

# DEFA-1776
SecRule REQUEST_METHOD "@streq POST" "id:77140846,chain,phase:2,pass,log,t:none,t:normalizePath,msg:'IM360 WAF: Joomla jDownloads 1.0 Arbitrary File Upload||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'joomla_plugin'"
SecRule ARGS_GET:option "@streq com_jdownloads" "chain,t:none,t:lowercase"
SecRule ARGS_GET:view "@streq upload" "chain,t:none,t:lowercase"
SecRule &ARGS_GET:Itemid "@gt 0" "chain,t:none"
SecRule FILES "@rx (\.htaccess|.+\.(pht|phtml|php\d?)$)" "t:urlDecodeUni,t:removeWhitespace"

# DEFA-1777
SecRule REQUEST_FILENAME "@endsWith s5_media_player/helper.php" "id:77140847,chain,phase:2,block,log,t:none,t:lowercase,t:normalizePath,msg:'IM360 WAF: Joomla Shape 5 MP3 Player 2.0 Local File Disclosure||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'joomla_plugin'"
SecRule ARGS_GET:fileurl "!@rx ^$" "t:none"

# DEFA-1778
SecRule REQUEST_METHOD "@streq POST" "id:77140848,chain,phase:2,pass,log,t:none,t:normalizePath,msg:'IM360 WAF: Joomla JCE 2.6.33 Arbitrary File Upload||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'joomla_plugin'"
SecRule ARGS_GET:option "@streq com_jce" "chain,t:none,t:lowercase"
SecRule ARGS_GET:task "@streq plugin" "chain,t:none,t:lowercase"
SecRule ARGS_GET:plugin "@streq imgmanager" "chain,t:none,t:lowercase"
SecRule ARGS_GET:file "@streq imgmanager" "chain,t:none,t:lowercase"
SecRule ARGS_GET:method "@streq form" "chain,t:none,t:lowercase"
SecRule FILES "@rx (\.htaccess|.+\.(pht|phtml|php\d?)$)" "t:urlDecodeUni,t:removeWhitespace"

# DEFA-1779
SecRule REQUEST_METHOD "@streq POST" "id:77140849,chain,phase:2,block,log,t:none,t:normalizePath,msg:'IM360 WAF: Joomla com_Myblog Exploit Arbitrary File Upload Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'joomla_plugin'"
SecRule ARGS_GET:option "@streq com_myblog" "chain,t:none,t:lowercase"
SecRule ARGS_GET:task "@streq ajaxupload" "chain,t:none,t:lowercase"
SecRule FILES "@rx (\.htaccess|.+\.(pht|phtml|php\d?)$)" "t:urlDecodeUni,t:removeWhitespace"

# DEFA-1780
SecRule ARGS_GET:option "@streq com_macgallery" "id:77140850,chain,phase:2,block,log,t:none,t:lowercase,msg:'IM360 WAF: Joomla com_macgallery 1.5 Arbitrary File Download||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'joomla_plugin'"
SecRule ARGS_GET:view "@streq download" "chain,t:none,t:lowercase"
SecRule ARGS_GET:albumid "@rx \.\.\/" "t:none,t:urlDecodeUni,t:normalizePath"

# DEFA-1781
SecRule ARGS_GET:option "@streq com_joomanager" "id:77140851,chain,phase:2,block,log,t:none,t:lowercase,msg:'IM360 WAF: Joomla com_Joomanager Arbitrary File Download||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'joomla_plugin'"
SecRule ARGS_GET:controller "@streq details" "chain,t:none,t:lowercase"
SecRule ARGS_GET:task "@streq download" "chain,t:none,t:lowercase"
SecRule ARGS_GET:path "!@rx ^$" "t:none"

# Tracking SQL-dorks queries
SecRule REQUEST_FILENAME "@rx (product|item|product-list|productlist|product_info|product-display|item_book|product_detail|pages|producto)\.php$" "id:77140852,chain,phase:2,pass,log,t:none,t:lowercase,msg:'IM360 WAF: SQL Dorks collection for SQL Injection||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS_GET:product_id|ARGS_GET:pid|ARGS_GET:productid|ARGS_GET:gubun|ARGS_GET:pr|ARGS_GET:page_code|ARGS_GET:id|ARGS_GET:tid|ARGS_GET:sku|ARGS_GET:shopprodid|ARGS_GET:products_id|ARGS_GET:fid|ARGS_GET:cat|ARGS_GET:act "!@rx ^$" "t:none,t:lowercase"

# DEFA-1797
SecRule REQUEST_METHOD "@streq POST" "id:77140853,chain,phase:2,pass,log,t:none,t:normalizePath,msg:'WordPress Plugin MailPoet Newsletters 2.6.8 wysija-newsletters Arbitrary File Upload Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_plugin_wysija'"
SecRule REQUEST_FILENAME "@endsWith wp-admin/admin-post.php" "chain,t:none,t:normalizePath"
SecRule ARGS:page "@streq wysija_campaigns" "chain,t:none,t:lowercase"
SecRule ARGS:action "@streq themes" "chain,t:none,t:lowercase"
SecRule FILES "@rx (\.htaccess|.+\.(pht|phtml|php\d?)$)" "t:urlDecodeUni,t:removeWhitespace"

# DEFA-1806
SecRule REQUEST_METHOD "@rx ^POST$" "id:77140855,chain,phase:2,block,log,t:none,t:normalizePath,msg:'WordPress Plugin N-Media Website Contact Form with File Upload Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_plugin_n-media_contact_form'"
SecRule REQUEST_BASENAME "@rx (?:upload_settings_image|admin-ajax)\.php" "chain,t:none,t:urlDecodeUni"
SecRule ARGS_POST:action "@streq nm_webcontact_upload_file" "chain,t:none"
SecRule FILES "@rx \.(?:p(?:[ly]|h(?:p[2-7s]?|t(?:ml)?)|if)|c(?:o(?:nf|m)|gi|md|nf|pl)|ht(?:access|passwd|ml?)|m(?:ht(?:ml)?|si)|j(?:html|sb?)|s(?:html|cr)|v(?:bs|xd)|xht(?:ml)?|i(?:ni|v)|bat|dll|exe|key|aspx?|sh|rb|js)$" "t:none,t:urlDecodeUni"

# DEFA-1808
SecRule ARGS_POST "@rx ^[0-9a-zA-Z+/]{200}" "chain,id:77140860,phase:2,log,auditlog,pass,t:none,msg:'Encrypted malicious code detected||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule MATCHED_VAR_NAME "@rx ^ARGS_POST:[a-z]{1,7}$" "chain,t:none"
SecRule &ARGS_POST:__utmc "@eq 0" "t:none"

# DEFA-1808
SecRule &ARGS_POST:jweyc "@eq 1" "chain,id:77140861,phase:2,log,auditlog,block,status:403,t:none,msg:'Encrypted malicious code detected||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}', tag:'i360custom'"
SecRule &ARGS_POST:callbrhy "@eq 1" "t:none"

# DEFA-1808
SecRule FILES "@streq 199877.php" "id:77140862,phase:2,log,auditlog,block,t:none,msg:'Malicious upload attempt||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"

# DEFA-1808
SecRule ARGS_POST:a "@streq RC" "chain,id:77140863,phase:2,log,auditlog,block,t:none,msg:'Malicious code detected||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule &ARGS_POST:/^[a-z]+$/ "@ge 4" "t:none"

# DEFA-1809
SecRule ARGS "@rx ^die\((?:pi\(\)\*\d+|@?md5\(\w+\)|[=.!\x27\x5c]+|)" "id:77140864,phase:2,log,auditlog,block,t:none,msg:'Remote code execution fingerprint attempt||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"

# DEFA-1815
SecRule REQUEST_METHOD "@rx ^POST$" "id:77140865,chain,phase:2,block,log,t:none,t:normalizePath,msg:'WordPress Theme Konzept Arbitrary File Upload Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_plugin_theme_konzept'"
SecRule REQUEST_FILENAME "@endsWith /includes/uploadify/upload.php" "chain,t:none,t:normalizePath"
SecRule FILES "@rx \.(?:p(?:[ly]|h(?:p[2-7s]?|t(?:ml)?)|if)|c(?:o(?:nf|m)|gi|md|nf|pl)|ht(?:access|passwd|ml?)|m(?:ht(?:ml)?|si)|j(?:html|sb?)|s(?:html|cr)|v(?:bs|xd)|xht(?:ml)?|i(?:ni|v)|bat|dll|exe|key|aspx?|sh|rb|js)$" "t:none,t:urlDecodeUni"

# DEFA-1817
SecRule ARGS:action "@streq upload-plugin" "id:77140866,chain,phase:2,log,auditlog,block,status:403,t:none,msg:'Malicious plugin upload attempt||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_core'"
SecRule REQUEST_HEADERS:Content-Type "@rx =[0-9a-f]{32}$" "chain,t:none"
SecRule REQUEST_URI "@rx \/wp-admin\/update\.php" "chain,t:none,t:lowercase"
SecRule REQUEST_HEADERS:Accept "@streq */*" "chain,t:none"
SecRule FILES:pluginzip "@rx ^[a-z]{7}\.zip$" "t:none"

# DEFA-1819
SecRule REQUEST_METHOD "@rx ^POST$" "id:77140867,chain,phase:2,block,log,t:none,t:normalizePath,msg:'WordPress Simple Ads Manager Plugin File Upload Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_plugin_cherry'"
SecRule REQUEST_FILENAME "@endsWith /wp-content/plugins/simple-ads-manager/sam-ajax-admin.php" "chain,t:none,t:normalizePath"
SecRule FILES "@rx \.(?:p(?:[ly]|h(?:p[2-7s]?|t(?:ml)?)|if)|c(?:o(?:nf|m)|gi|md|nf|pl)|ht(?:access|passwd|ml?)|m(?:ht(?:ml)?|si)|j(?:html|sb?)|s(?:html|cr)|v(?:bs|xd)|xht(?:ml)?|i(?:ni|v)|bat|dll|exe|key|aspx?|sh|rb|js)$" "t:none,t:urlDecodeUni"

# DEFA-1819
SecRule REQUEST_METHOD "@rx ^POST$" "id:77140868,chain,phase:2,block,log,t:none,t:normalizePath,msg:'WordPress Revslider Plugin File Upload Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_plugin_revslider'"
SecRule REQUEST_FILENAME "@endsWith /wp-admin/admin-ajax.php" "chain,t:none,t:normalizePath"
SecRule ARGS_POST:action "@streq revslider_ajax_action" "chain,t:none,t:urlDecodeUni"
SecRule ARGS_POST:client_action "@streq update_plugin" "chain,t:none,t:urlDecodeUni"
SecRule FILES "@rx \.(?:p(?:[ly]|h(?:p[2-7s]?|t(?:ml)?)|if)|c(?:o(?:nf|m)|gi|md|nf|pl)|ht(?:access|passwd|ml?)|m(?:ht(?:ml)?|si)|j(?:html|sb?)|s(?:html|cr)|v(?:bs|xd)|xht(?:ml)?|i(?:ni|v)|bat|dll|exe|key|aspx?|sh|rb|js)$" "t:none,t:urlDecodeUni"

# DEFA-1819
SecRule REQUEST_METHOD "@rx ^POST$" "id:77140869,chain,phase:2,block,log,t:none,t:normalizePath,msg:'WordPress Simple Ads Manager Plugin File Upload Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_plugin_simple_ads_manager'"
SecRule REQUEST_FILENAME "@endsWith /wp-content/plugins/simple-ads-manager/sam-ajax-admin.php" "chain,t:none,t:normalizePath"
SecRule ARGS_POST:action "@streq upload_ad_image" "chain,t:none,t:urlDecodeUni"
SecRule FILES "@rx \.(?:p(?:[ly]|h(?:p[2-7s]?|t(?:ml)?)|if)|c(?:o(?:nf|m)|gi|md|nf|pl)|ht(?:access|passwd|ml?)|m(?:ht(?:ml)?|si)|j(?:html|sb?)|s(?:html|cr)|v(?:bs|xd)|xht(?:ml)?|i(?:ni|v)|bat|dll|exe|key|aspx?|sh|rb|js)$" "t:none,t:urlDecodeUni"

# DEFA-1819
SecRule REQUEST_METHOD "@rx ^POST$" "id:77140870,chain,phase:2,block,log,t:none,t:normalizePath,msg:'WordPress FormCraft	Plugin File Upload Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_plugin_formcraft'"
SecRule REQUEST_URI "@rx \/wp-content\/plugins\/formcraft\/file-upload\/server\/(?:php|content)\/" "chain,t:none,t:normalizePath"
SecRule FILES "@rx \.(?:p(?:[ly]|h(?:p[2-7s]?|t(?:ml)?)|if)|c(?:o(?:nf|m)|gi|md|nf|pl)|ht(?:access|passwd|ml?)|m(?:ht(?:ml)?|si)|j(?:html|sb?)|s(?:html|cr)|v(?:bs|xd)|xht(?:ml)?|i(?:ni|v)|bat|dll|exe|key|aspx?|sh|rb|js)$" "t:none,t:urlDecodeUni"

# DEFA-1819
SecRule REQUEST_METHOD "@rx ^POST$" "id:77140871,chain,phase:2,block,log,t:none,t:normalizePath,msg:'WordPress Downloads Manager Plugin File Upload Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_plugin_downloads_manager'"
SecRule REQUEST_URI "@rx \/wp-content\/plugins\/downloads-manager\/" "chain,t:none,t:normalizePath"
SecRule FILES "@rx \.(?:p(?:[ly]|h(?:p[2-7s]?|t(?:ml)?)|if)|c(?:o(?:nf|m)|gi|md|nf|pl)|ht(?:access|passwd|ml?)|m(?:ht(?:ml)?|si)|j(?:html|sb?)|s(?:html|cr)|v(?:bs|xd)|xht(?:ml)?|i(?:ni|v)|bat|dll|exe|key|aspx?|sh|rb|js)$" "t:none,t:urlDecodeUni"

# DEFA-1821
SecRule ARGS_GET:url "@beginsWith pastebin.com/raw/" "id:77140872,chain,phase:2,pass,log,t:none,t:lowercase,msg:'Malicious code download attempt||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS_GET:path "@beginsWith ww-te" "t:none"

# DEFA-1822
SecRule REQUEST_FILENAME "@endsWith /pack/pack1.php" "id:77140873,chain,phase:2,pass,log,t:none,t:normalizePath,t:lowercase,msg:'Malicious code execution attempt||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS_GET:path "@beginsWith /" "chain,t:none,t:base64DecodeExt"
SecRule &ARGS:new "@eq 1" "t:none"

# DEFA-1794
SecRule ARGS_GET:a "@contains /bin/sh -c 'which which'" "id:77140874,msg:'IM360 WAF: Sensor for CVE-2019-11043 (PHuiP-FPizdaM) exploit request||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',phase:2,pass,t:none,t:urlDecode,tag:'i360custom'"

# DEFA-1826
SecRule REQUEST_METHOD "@rx ^POST$" "id:77140875,chain,phase:2,pass,log,t:none,t:normalizePath,msg:'Joomla Com_Fabrik 3.9 controller File Upload Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_plugin_revslider'"
SecRule REQUEST_FILENAME "@endsWith index.php" "chain,t:none,t:normalizePath"
SecRule ARGS_GET:action "@streq com_fabrik" "chain,t:none,t:urlDecodeUni"
SecRule ARGS_GET:task "@streq plugin.pluginAjax" "chain,t:none,t:urlDecodeUni"
SecRule ARGS_GET:plugin "@streq fileupload" "chain,t:none"
SecRule FILES "@rx \.(?:p(?:[ly]|h(?:p[2-7s]?|t(?:ml)?)|if)|c(?:o(?:nf|m)|gi|md|nf|pl)|ht(?:access|passwd|ml?)|m(?:ht(?:ml)?|si)|j(?:html|sb?)|s(?:html|cr)|v(?:bs|xd)|xht(?:ml)?|i(?:ni|v)|bat|dll|exe|key|aspx?|sh|rb|js)$" "t:none,t:urlDecodeUni"

# Track Wordpress ?author=1 usernames check
SecRule ARGS_GET:author "@ge 1" "id:77140876,msg:'Track Wordpress users enumeration||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',phase:2,pass,t:none,auditlog,t:urlDecode,tag:'i360custom',tag:'noshow'"

SecRule ARGS_GET:author "@ge 1" "id:77140879,msg:'RBL Block Wordpress users enumeration||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',phase:2,block,t:none,auditlog,t:urlDecode,tag:'i360custom',tag:'noshow',chain"
SecRule TX:RBL_IP "@rbl www-brute.v2.rbl.imunify.com." "t:none,chain"
SecRule TX:RBL_IP "!@rbl nxdomain.v2.rbl.imunify.com." "t:none"

# DEFA-1843
SecRule ARGS "@rx ^\\[\x22\x27]><script\w+src=[\x22\x27][^\x22\x27]+[\x22\x27][^<]+<\/script>$|cd\.privacylocationforloc\.com" "id:77140877,phase:2,pass,log,t:none,t:lowercase,msg:'IM360 WAF: XSS exploitation attempt (cd.privacylocationforloc.com)||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"


# Infectors from COMODO

SecRule ARGS|ARGS_NAMES|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|XML:/*|!ARGS:/body/|!ARGS:/content/|!ARGS:/description/|!ARGS:/message/|!ARGS:Post|!ARGS:desc|!ARGS:text|!ARGS:textarea|!REQUEST_COOKIES:/__utm/|!REQUEST_COOKIES:/_pk_ref/ "(?i)(?:\b(?:f(?:tp_(?:nb_)?f?(?:ge|pu)t|get(?:s?s|c)|scanf|write|open|read)|gz(?:(?:encod|writ)e|compress|open|read)|s(?:ession_start|candir)|read(?:(?:gz)?file|dir)|move_uploaded_file|(?:proc_|bz)open|call_user_func)|\$_(?:(?:pos|ge)t|session))\b" "id:77140880,msg:'Infectors: PHP Injection Attack||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}||SC:%{SCRIPT_FILENAME}',phase:2,capture,block,ctl:auditLogParts=+E,t:none,rev:1,severity:2,tag:'noshow',chain"
SecRule TX:RBL_IP "@rbl infectors.v2.rbl.imunify.com." "t:none,chain"
SecRule TX:RBL_IP "!@rbl nxdomain.v2.rbl.imunify.com." "t:none"

SecRule ARGS|ARGS_NAMES|REQUEST_URI|REQUEST_HEADERS:User-Agent|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|XML:/*|!ARGS:/body/|!ARGS:/content/|!ARGS:/description/|!ARGS:Post|!ARGS:desc|!ARGS:html_message|!ARGS:text|!REQUEST_COOKIES:/__utm/|!REQUEST_COOKIES:/_pk_ref/ "@rx (?:print|echo|eval|exec)\(" "id:77140881,msg:'Infectors: Arbitrary code execution vulnerability in Request URI||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}||SC:%{SCRIPT_FILENAME}',phase:2,block,log,t:none,t:urlDecodeUni,t:removeWhitespace,t:lowercase,rev:1,severity:2,tag:'noshow',chain"
SecRule TX:RBL_IP "@rbl infectors.v2.rbl.imunify.com." "t:none,chain"
SecRule TX:RBL_IP "!@rbl nxdomain.v2.rbl.imunify.com." "t:none"

SecRule ARGS|ARGS_NAMES|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|XML:/*|!ARGS:/body/|!ARGS:code|!ARGS:/content/|!ARGS:/description/|!ARGS:/install\[values\]\[\w+\]\[fileDenyPattern\]/|!ARGS:/message/|!ARGS:Post|!ARGS:desc|!ARGS:text|!REQUEST_COOKIES:/__utm/|!REQUEST_COOKIES:/_pk_ref/|!ARGS:wpTextbox1 "(?:(?<!\w)(?:\.(?:ht(?:access|group|passwd)|www_{0,1}acl)|boot\.ini|global\.asa|httpd\.conf)\b|/etc/)" "id:77140882,chain,msg:'Infectors: Remote File Access Attempt||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}||SC:%{SCRIPT_FILENAME}',phase:2,capture,block,ctl:auditLogParts=+E,t:none,t:cmdLine,rev:9,severity:2,tag:'noshow'"
SecRule REQUEST_URI "!@pm cpanel AdminTranslations" "t:none,chain"
SecRule TX:RBL_IP "@rbl infectors.v2.rbl.imunify.com." "t:none,chain"
SecRule TX:RBL_IP "!@rbl nxdomain.v2.rbl.imunify.com." "t:none"

# Uploader
SecRule ARGS_GET:url "!rx ^$" "id:77140883,chain,phase:2,log,block,t:urlDecode,t:removeWhitespace,msg:'RBL block known shells||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}||SC:%{SCRIPT_FILENAME}',tag:'i360custom'"
SecRule ARGS_GET:path "!@rx ^$" "t:none,chain"
SecRule TX:RBL_IP "@rbl infectors.v2.rbl.imunify.com." "t:none,chain"
SecRule TX:RBL_IP "!@rbl nxdomain.v2.rbl.imunify.com." "t:none"

# WSO
SecRule ARGS_POST:a "!rx ^$" "id:77140884,chain,phase:2,log,block,t:urlDecode,t:removeWhitespace,msg:'RBL block known shells||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}||SC:%{SCRIPT_FILENAME}',tag:'i360custom'"
SecRule ARGS_POST:p1 "!@rx ^$" "t:none,chain"
SecRule TX:RBL_IP "@rbl infectors.v2.rbl.imunify.com." "t:none,chain"
SecRule TX:RBL_IP "!@rbl nxdomain.v2.rbl.imunify.com." "t:none"

# S.A.P.
SecRule REQUEST_COOKIES:f_pp|ARGS:f_pp "!rx ^$" "id:77140885,chain,phase:2,log,block,t:urlDecode,t:removeWhitespace,msg:'RBL block known shells||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}||SC:%{SCRIPT_FILENAME}',tag:'i360custom'"
SecRule TX:RBL_IP "@rbl infectors.v2.rbl.imunify.com." "t:none,chain"
SecRule TX:RBL_IP "!@rbl nxdomain.v2.rbl.imunify.com." "t:none"

# z0
SecRule ARGS:z0 "!rx ^$" "id:77140886,chain,phase:2,log,block,t:urlDecode,t:removeWhitespace,msg:'RBL block known shells||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}||SC:%{SCRIPT_FILENAME}',tag:'i360custom'"
SecRule TX:RBL_IP "@rbl infectors.v2.rbl.imunify.com." "t:none,chain"
SecRule TX:RBL_IP "!@rbl nxdomain.v2.rbl.imunify.com." "t:none"


# DEFA-1821
SecRule ARGS_GET:url "@beginsWith pastebin.com/raw/" "id:77140892,chain,phase:2,pass,log,t:none,t:lowercase,msg:'Malicious code download attempt||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS_GET:path "@beginsWith ww-te" "t:none"

# DEFA-1822
SecRule REQUEST_FILENAME "@endsWith /pack/pack1.php" "id:77140893,chain,phase:2,pass,log,t:none,t:normalizePath,t:lowercase,msg:'Malicious code execution attempt||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule ARGS_GET:path "@beginsWith /" "chain,t:none,t:base64DecodeExt"
SecRule &ARGS:new "@eq 1" "t:none"

# DEFA-1794
SecRule ARGS_GET:a "@contains /bin/sh -c 'which which'" "id:77140894,msg:'IM360 WAF: Sensor for CVE-2019-11043 (PHuiP-FPizdaM) exploit request||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',phase:2,pass,t:none,t:urlDecode,tag:'i360custom'"

# DEFA-1819
SecRule REQUEST_METHOD "@rx ^POST$" "id:77140901,chain,phase:2,block,log,t:none,t:normalizePath,msg:'Joomla simplefileupload component File Upload Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'joomla_plugin'"
SecRule REQUEST_FILENAME "@endsWith /modules/mod_simplefileuploadv1.3/elements/udd.php" "chain,t:none,t:normalizePath"
SecRule FILES "@rx \.(?:p(?:[ly]|h(?:p[2-7s]?|t(?:ml)?)|if)|c(?:o(?:nf|m)|gi|md|nf|pl)|ht(?:access|passwd|ml?)|m(?:ht(?:ml)?|si)|j(?:html|sb?)|s(?:html|cr)|v(?:bs|xd)|xht(?:ml)?|i(?:ni|v)|bat|dll|exe|key|aspx?|sh|rb|js)$" "t:none,t:urlDecodeUni"

# DEFA-1819
SecRule REQUEST_METHOD "@rx ^POST$" "id:77140902,chain,phase:2,block,log,t:none,t:normalizePath,msg:'Joomla com_facileforms component File Upload Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'joomla_plugin'"
SecRule REQUEST_FILENAME "@endsWith /components/com_facileforms/libraries/jquery/uploadify.php" "chain,t:none,t:normalizePath"
SecRule FILES "@rx \.(?:p(?:[ly]|h(?:p[2-7s]?|t(?:ml)?)|if)|c(?:o(?:nf|m)|gi|md|nf|pl)|ht(?:access|passwd|ml?)|m(?:ht(?:ml)?|si)|j(?:html|sb?)|s(?:html|cr)|v(?:bs|xd)|xht(?:ml)?|i(?:ni|v)|bat|dll|exe|key|aspx?|sh|rb|js)$" "t:none,t:urlDecodeUni"

# DEFA-1819
SecRule REQUEST_METHOD "@rx ^POST$" "id:77140903,chain,phase:2,block,log,t:none,t:normalizePath,msg:'FCKEditor Core 2.x 2.4.3 File Upload Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_plugin_fckeditor'"
SecRule REQUEST_FILENAME "@endsWith /wp-admin/admin-ajax.php" "chain,t:none,t:normalizePath"
SecRule ARGS_GET:param "@streq upload_slide" "chain,t:none,t:urlDecodeUni"
SecRule ARGS_GET:action "@streq load_library" "chain,t:none,t:urlDecodeUni"
SecRule FILES "@rx \.(?:p(?:[ly]|h(?:p[2-7s]?|t(?:ml)?)|if)|c(?:o(?:nf|m)|gi|md|nf|pl)|ht(?:access|passwd|ml?)|m(?:ht(?:ml)?|si)|j(?:html|sb?)|s(?:html|cr)|v(?:bs|xd)|xht(?:ml)?|i(?:ni|v)|bat|dll|exe|key|aspx?|sh|rb|js)$" "t:none,t:urlDecodeUni"

# DEFA-1819
SecRule REQUEST_METHOD "@rx ^POST$" "id:77140904,chain,phase:2,block,log,t:none,t:normalizePath,msg:'Joomla collector component File Upload Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'joomla_plugin'"
SecRule REQUEST_FILENAME "@endsWith index.php" "chain,t:none,t:normalizePath"
SecRule ARGS_GET:option "@streq com_collector" "chain,t:none,t:urlDecodeUni"
SecRule ARGS_GET:view "@streq filelist" "chain,t:none,t:urlDecodeUni"
SecRule ARGS_GET:tmpl "@streq component" "chain,t:none,t:urlDecodeUni"
SecRule FILES "@rx \.(?:p(?:[ly]|h(?:p[2-7s]?|t(?:ml)?)|if)|c(?:o(?:nf|m)|gi|md|nf|pl)|ht(?:access|passwd|ml?)|m(?:ht(?:ml)?|si)|j(?:html|sb?)|s(?:html|cr)|v(?:bs|xd)|xht(?:ml)?|i(?:ni|v)|bat|dll|exe|key|aspx?|sh|rb|js)$" "t:none,t:urlDecodeUni"

# DEFA-1819
SecRule REQUEST_METHOD "@rx ^POST$" "id:77140905,chain,phase:2,block,log,t:none,t:normalizePath,msg:'Joomla Codextrous B2jcontact 2.1.17 File Upload Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'joomla_plugin'"
SecRule REQUEST_FILENAME "@endsWith index.php" "chain,t:none,t:normalizePath"
SecRule ARGS_GET:option "@streq com_b2jcontact" "chain,t:none,t:urlDecodeUni"
SecRule ARGS_GET:view "@streq loader" "chain,t:none,t:urlDecodeUni"
SecRule ARGS_GET:qqfile "@rx \.\.\/\.\.\.\/" "chain,t:none,t:urlDecodeUni"
SecRule FILES "@rx \.(?:p(?:[ly]|h(?:p[2-7s]?|t(?:ml)?)|if)|c(?:o(?:nf|m)|gi|md|nf|pl)|ht(?:access|passwd|ml?)|m(?:ht(?:ml)?|si)|j(?:html|sb?)|s(?:html|cr)|v(?:bs|xd)|xht(?:ml)?|i(?:ni|v)|bat|dll|exe|key|aspx?|sh|rb|js)$" "t:none,t:urlDecodeUni"

# DEFA-1819
SecRule REQUEST_METHOD "@rx ^POST$" "id:77140906,chain,phase:2,block,log,t:none,t:normalizePath,msg:'WordPress plugin pageline File Upload Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wordpress_plugin_pageline'"
SecRule REQUEST_FILENAME "@rx (?:wp-admin\/admin-post\.php|wp-admin\/admin-ajax\.php)$" "chain,t:none,t:normalizePath"
SecRule ARGS_POST:page "@streq pagelines" "chain,t:none,t:urlDecodeUni"
SecRule ARGS_POST:settings_upload "@streq settings" "chain,t:none,t:urlDecodeUni"
SecRule FILES "@rx \.(?:p(?:[ly]|h(?:p[2-7s]?|t(?:ml)?)|if)|c(?:o(?:nf|m)|gi|md|nf|pl)|ht(?:access|passwd|ml?)|m(?:ht(?:ml)?|si)|j(?:html|sb?)|s(?:html|cr)|v(?:bs|xd)|xht(?:ml)?|i(?:ni|v)|bat|dll|exe|key|aspx?|sh|rb|js)$" "t:none,t:urlDecodeUni"

# DEFA-1819
SecRule REQUEST_METHOD "@rx ^POST$" "id:77140907,chain,phase:2,block,log,t:none,t:normalizePath,msg:'WordPress Downloads Manager Plugin File Upload Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_plugin_downloads_manager'"
SecRule REQUEST_URI "@rx /wp-content/plugins/dzs-videogallery/admin/upload.php" "chain,t:none,t:normalizePath"
SecRule FILES "@rx \.(?:p(?:[ly]|h(?:p[2-7s]?|t(?:ml)?)|if)|c(?:o(?:nf|m)|gi|md|nf|pl)|ht(?:access|passwd|ml?)|m(?:ht(?:ml)?|si)|j(?:html|sb?)|s(?:html|cr)|v(?:bs|xd)|xht(?:ml)?|i(?:ni|v)|bat|dll|exe|key|aspx?|sh|rb|js)$" "t:none,t:urlDecodeUni"

# DEFA-1819
SecRule REQUEST_METHOD "@rx ^POST$" "id:77140908,chain,phase:2,block,log,t:none,t:normalizePath,msg:'WordPress Simple Ads Manager Plugin File Upload Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_plugin_simple_ads_manager'"
SecRule REQUEST_FILENAME "@endsWith /wp-content/plugins/social-networking-e-commerce-1/classes/views/social-options/form_cat_add.php" "chain,t:none,t:normalizePath"
SecRule ARGS_POST:config_path "@rx \.\.\/\.\.\/" "chain,t:none,t:urlDecodeUni"
SecRule FILES "@rx \.(?:p(?:[ly]|h(?:p[2-7s]?|t(?:ml)?)|if)|c(?:o(?:nf|m)|gi|md|nf|pl)|ht(?:access|passwd|ml?)|m(?:ht(?:ml)?|si)|j(?:html|sb?)|s(?:html|cr)|v(?:bs|xd)|xht(?:ml)?|i(?:ni|v)|bat|dll|exe|key|aspx?|sh|rb|js)$" "t:none,t:urlDecodeUni"

# DEFA-1819
SecRule REQUEST_METHOD "@rx ^POST$" "id:77140909,chain,phase:2,block,log,t:none,t:normalizePath,msg:'WordPress Viral Optins Plugin File Upload Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_plugin_viral_optins'"
SecRule REQUEST_FILENAME "@endsWith /wp-content/plugins/viral-optins/api/uploader/file-uploader.php" "chain,t:none,t:normalizePath"
SecRule FILES "@rx \.(?:p(?:[ly]|h(?:p[2-7s]?|t(?:ml)?)|if)|c(?:o(?:nf|m)|gi|md|nf|pl)|ht(?:access|passwd|ml?)|m(?:ht(?:ml)?|si)|j(?:html|sb?)|s(?:html|cr)|v(?:bs|xd)|xht(?:ml)?|i(?:ni|v)|bat|dll|exe|key|aspx?|sh|rb|js)$" "t:none,t:urlDecodeUni"

# DEFA-1819
SecRule REQUEST_METHOD "@rx ^POST$" "id:77140910,chain,phase:2,block,log,t:none,t:normalizePath,msg:'WordPress Slider Revolution 3.0.95 / Showbiz Pro 1.7.1 Plugin File Upload Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_plugin_slider_revolition',tag:'wp_plugin_showbiz'"
SecRule REQUEST_FILENAME "@endsWith /admin-ajax.php" "chain,t:none,t:normalizePath"
SecRule ARGS_POST:action "@streq showbiz_ajax_action" "chain,t:none,t:urlDecodeUni"
SecRule ARGS_POST:client_action "@streq update_plugin" "chain,t:none,t:urlDecodeUni"
SecRule FILES "@rx \.(?:p(?:[ly]|h(?:p[2-7s]?|t(?:ml)?)|if)|c(?:o(?:nf|m)|gi|md|nf|pl)|ht(?:access|passwd|ml?)|m(?:ht(?:ml)?|si)|j(?:html|sb?)|s(?:html|cr)|v(?:bs|xd)|xht(?:ml)?|i(?:ni|v)|bat|dll|exe|key|aspx?|sh|rb|js)$" "t:none,t:urlDecodeUni"

# DEFA-1819
SecRule REQUEST_METHOD "@rx ^POST$" "id:77140911,chain,phase:2,block,log,t:none,t:normalizePath,msg:'Joomla! com_extplorer Components File Upload Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'joomla_plugin'"
SecRule REQUEST_FILENAME "@endsWith components/com_extplorer/uploadhandler.php" "chain,t:none,t:normalizePath"
SecRule FILES "@rx \.(?:p(?:[ly]|h(?:p[2-7s]?|t(?:ml)?)|if)|c(?:o(?:nf|m)|gi|md|nf|pl)|ht(?:access|passwd|ml?)|m(?:ht(?:ml)?|si)|j(?:html|sb?)|s(?:html|cr)|v(?:bs|xd)|xht(?:ml)?|i(?:ni|v)|bat|dll|exe|key|aspx?|sh|rb|js)$" "t:none,t:urlDecodeUni"

# DEFA-1819
SecRule REQUEST_METHOD "@rx ^POST$" "id:77140912,chain,phase:2,block,log,t:none,t:normalizePath,msg:'WordPress Easy WP SMTP Plugin File Upload Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_plugin_easy_wp_smtp'"
SecRule REQUEST_FILENAME "@endsWith wp-admin/admin-post.php" "chain,t:none,t:normalizePath"
SecRule &ARGS_POST:/swpsmtp_import_se/ "@gt 0 " "chain,t:none,t:urlDecodeUni"
SecRule ARGS_POST:action "@streq swpsmtp_clear_log" "chain,t:none,t:urlDecodeUni"
SecRule FILES "@rx \.(?:p(?:[ly]|h(?:p[2-7s]?|t(?:ml)?)|if)|c(?:o(?:nf|m)|gi|md|nf|pl)|ht(?:access|passwd|ml?)|m(?:ht(?:ml)?|si)|j(?:html|sb?)|s(?:html|cr)|v(?:bs|xd)|xht(?:ml)?|i(?:ni|v)|bat|dll|exe|key|aspx?|sh|rb|js)$" "t:none,t:urlDecodeUni"

#74 DEFA-1819
SecRule REQUEST_METHOD "@rx ^POST$" "id:77140913,chain,phase:2,block,log,t:none,t:normalizePath,msg:'WordPress Satoshi Theme File Upload Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_plugin_satoshi'"
SecRule REQUEST_FILENAME "@endsWith /wp-content/themes/satoshi/functions/upload-handler.php" "chain,t:none,t:normalizePath"
SecRule FILES "@rx \.(?:p(?:[ly]|h(?:p[2-7s]?|t(?:ml)?)|if)|c(?:o(?:nf|m)|gi|md|nf|pl)|ht(?:access|passwd|ml?)|m(?:ht(?:ml)?|si)|j(?:html|sb?)|s(?:html|cr)|v(?:bs|xd)|xht(?:ml)?|i(?:ni|v)|bat|dll|exe|key|aspx?|sh|rb|js)$" "t:none,t:urlDecodeUni"

# DEFA-1819
SecRule REQUEST_METHOD "@rx ^POST$" "id:77140914,chain,phase:2,block,log,t:none,t:normalizePath,msg:'WordPress iThemes2 Theme File Upload Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_plugin_ithemes2'"
SecRule REQUEST_FILENAME "@endsWith /wp-content/themes/ithemes2/themify/themify-ajax.php" "chain,t:none,t:normalizePath"
SecRule ARGS_GET:upload "@streq 1" "chain,t:none,t:urlDecodeUni"
SecRule FILES "@rx \.(?:p(?:[ly]|h(?:p[2-7s]?|t(?:ml)?)|if)|c(?:o(?:nf|m)|gi|md|nf|pl)|ht(?:access|passwd|ml?)|m(?:ht(?:ml)?|si)|j(?:html|sb?)|s(?:html|cr)|v(?:bs|xd)|xht(?:ml)?|i(?:ni|v)|bat|dll|exe|key|aspx?|sh|rb|js)$" "t:none,t:urlDecodeUni"

# DEFA-1819
SecRule REQUEST_METHOD "@rx ^POST$" "id:77140915,chain,phase:2,block,log,t:none,t:normalizePath,msg:'WordPress css.images.php RCE||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule REQUEST_FILENAME "@endsWith /wp-admin/css.images.php" "chain,t:none,t:normalizePath"
SecRule ARGS_POST:catch "@streq assert" "chain,t:none,t:urlDecodeUni"
SecRule ARGS_POST:except "@rx eval\(" "t:none,t:urlDecodeUni"

# DEFA-1819
SecRule REQUEST_METHOD "@rx ^POST$" "id:77140916,chain,phase:2,block,log,t:none,t:normalizePath,msg:'WordPress connector.minimal.php File Upload Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule REQUEST_FILENAME "@endsWith /demo/php/connector.minimal.php" "chain,t:none,t:normalizePath"
SecRule ARGS_POST:cmd "@streq upload" "chain,t:none,t:urlDecodeUni"
SecRule &ARGS_POST:target "@gt 0" "chain,t:none"
SecRule &ARGS_POST:reqid "@gt 0" "chain,t:none"
SecRule FILES "@rx echo\b" "t:none,t:urlDecodeUni"

# DEFA-1782
SecRule REQUEST_METHOD "@rx ^GET$" "id:77140917,chain,phase:2,pass,log,t:none,t:normalizePath,msg:'WordPress eShop Magic Arbitrary File Access||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_plugin_eshop_magic'"
SecRule REQUEST_FILENAME "@endsWith /wp-content/plugins/eshop-magic/download.php" "chain,t:none,t:normalizePath"
SecRule ARGS_GET:file "@rx \.\.\/\.\.\/" "t:none,t:urlDecodeUni"

# DEFA-1783
SecRule REQUEST_METHOD "@rx ^GET$" "id:77140918,chain,phase:2,pass,log,t:none,t:normalizePath,msg:'WordPress Mobile Detector 3.5 plugin file Upload Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_plugin_mobile_detector'"
SecRule REQUEST_FILENAME "@endsWith wp-content/plugins/wp-mobile-detector/resize.php" "chain,t:none,t:normalizePath"
SecRule ARGS_GET:src "!@rx ^(?:ht|f)tps?:\/\/%{SERVER_NAME}" "t:none,t:urlDecodeUni"

# DEFA-1784
SecRule REQUEST_METHOD "@rx ^GET$" "id:77140919,chain,phase:2,pass,log,t:none,t:normalizePath,msg:'ThinkPHP 5.X - Remote Command Execution Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule REQUEST_FILENAME "@endsWith /index.php" "chain,t:none,t:normalizePath"
SecRule ARGS_GET:function "@streq call_user_func_array" "chain,t:none"
SecRule ARGS_GET:s "@rx ^index\/\\think" "chain,t:none,t:urlDecodeUni"
SecRule ARGS_GET:/^vars\[/ "!@rx ^$" "t:none"

# DEFA-1784
SecRule REQUEST_METHOD "@rx ^GET$" "id:77140920,chain,phase:2,pass,log,t:none,t:normalizePath,msg:'ThinkPHP 5.X - Remote Command Execution Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule REQUEST_FILENAME "@endsWith /index.php" "chain,t:none,t:normalizePath"
SecRule ARGS_GET:s "@streq .|think\config/get" "chain,t:none,t:urlDecodeUni"
SecRule ARGS_GET:name "!@rx ^$" "t:none"

# DEFA-1784
SecRule REQUEST_METHOD "@rx ^GET$" "id:77140921,chain,phase:2,pass,log,t:none,t:normalizePath,msg:'ThinkPHP 5.X SQLi Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule REQUEST_FILENAME "@endsWith /index.php" "chain,t:none,t:normalizePath"
SecRule ARGS_GET:s "@rx ^\/home\/(?:article\/view_recent|shopcart\/getprice|user\/cut|service\/index|pay\/\w{0,20}\/orderid|order\/\w{0,20}\/id)\/" "chain,t:none,t:urlDecodeUni"
SecRule MATCHED_VAR "@contains '" "t:none"

# DEFA-1784
SecRule REQUEST_METHOD "@rx ^POST$" "id:77140922,chain,phase:2,pass,log,t:none,t:normalizePath,msg:'ThinkPHP 5.X RCE Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule REQUEST_FILENAME "@endsWith /index.php" "chain,t:none,t:normalizePath"
SecRule ARGS_POST:_metod "@streq __construct" "chain,t:none"
SecRule ARGS_POST:filter[] "@streq system" "chain,t:none"
SecRule ARGS_POST:server[request_method] "!@rx \w{3,4}" "t:none"

# DEFA-1785
SecRule REQUEST_METHOD "@rx ^GET$" "id:77140923,chain,phase:2,pass,log,t:none,t:normalizePath,msg:'Joomla Component Jreservation Blind SQLi Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'joomla_plugin'"
SecRule REQUEST_FILENAME "@endsWith /index.php" "chain,t:none,t:normalizePath"
SecRule ARGS_GET:option "@streq com_content" "chain,t:none"
SecRule ARGS_GET:view "@streq article" "chain,t:none"
SecRule ARGS_GET:id "@rx \D" "t:none"

# DEFA-1787
SecRule REQUEST_METHOD "@rx ^POST$" "id:77140924,chain,phase:2,pass,log,t:none,t:normalizePath,msg:'WordPress Cherry-Plugin File Upload Vulnerability||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom',tag:'wp_plugin_cherry_plugin'"
SecRule REQUEST_FILENAME "@endsWith wp-content/plugins/cherry-plugin/admin/import-export/upload.php" "chain,t:none,t:normalizePath"
SecRule FILES "@rx \.(?:p(?:[ly]|h(?:p[2-7s]?|t(?:ml)?)|if)|c(?:o(?:nf|m)|gi|md|nf|pl)|ht(?:access|passwd|ml?)|m(?:ht(?:ml)?|si)|j(?:html|sb?)|s(?:html|cr)|v(?:bs|xd)|xht(?:ml)?|i(?:ni|v)|bat|dll|exe|key|aspx?|sh|rb|js)$" "t:none,t:urlDecodeUni"

# DEFA-1859
SecRule ARGS:password "@rx ^[a-f0-9]{32}$" "id:77140925,chain,phase:2,pass,log,t:none,t:normalizePath,msg:'WordPress infected nulled themes/plugins request||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule &ARGS:change_domain "@ge 1" "chain,t:none"
SecRule ARGS:newdomain "!@rx ^$" "t:none,t:urlDecodeUni"

# DEFA-1859
SecRule ARGS:password "@rx ^[a-f0-9]{32}$" "id:77140926,chain,phase:2,pass,log,t:none,t:normalizePath,msg:'WordPress infected nulled themes/plugins request||MVN:%{MATCHED_VAR_NAME}||MV:%{MATCHED_VAR}||PC:%{PERF_COMBINED}',tag:'i360custom'"
SecRule &ARGS:change_code "@gt 0" "chain,t:none"
SecRule ARGS:newcode "!@rx ^$" "t:none,t:urlDecodeUni"
